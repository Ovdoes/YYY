<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        *{
            padding: 0;
            margin: 0;
        }
        .a{
            width: 50px;
            height: 50px;
            background: red;
            position: absolute;
            left: 0;
            top: 0;
        }
    </style>
</head>
<body>

<script>
    var str='';
    var timer=null;
    var num=0;
    var len=20;
    var bTrue=true;
    var odiv=document.getElementsByTagName('div');
    for(var i=0;i<len;i++){
        str+='<div class="a" style="left:'+i*60+'px"></div>';
    }
    document.body.innerHTML=str;

    document.onclick= function () {
       if(bTrue){
         toxia();
       }else{
           toshang();
       }
    };
    function toxia(){
        clearInterval(timer);
        timer=setInterval(function () {
            domove(odiv[num],20,500,'top');
            num++;
            if(num==len){
                clearInterval(timer);
                bTrue=false;
            }
        },60)
    }
    function toshang(){
        clearInterval(timer);
        timer=setInterval(function () {
            num--;
            domove(odiv[num],20,0,'top');
            if(num==0){
                clearInterval(timer);
                bTrue=true;
            }
        },60)
    }

    function domove(obj,dir,itarget,attr,fn){
        dir=parseInt(getByClass(obj,attr))<itarget?dir:-dir;
        clearInterval(obj.timer);
        obj.timer=setInterval(function () {
            var speed=parseInt(getByClass(obj,attr))+dir;
            if(speed>=itarget && dir>0){
                speed=itarget;
            }
            if(speed<=itarget && dir<0){
                speed=itarget;
            }
            obj.style[attr]=speed+'px';
            if(speed==itarget){
                clearInterval(obj.timer);
                if(fn){
                    fn();
                }
            }
        },30);
    }
    function getByClass(obj,attr){
        if(obj.currentStyle){
            return obj.currentStyle[attr];
        }else{
            return getComputedStyle(obj)[attr];
        }
    }
</script>
</body>
</html>